{
  "hash": "084e515340b41e66f2ad6c69d031af75",
  "result": {
    "markdown": "---\nformat: html\ntitle: \"Data Acquisition\"\nauthor: \"Preethi Aranala\"\n---\n\nDATA ACQUISITION\n\n# Challenge 2: WEBSCRAPING ----\n\n## Libraries ----\n\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-1_4c9e2c9626f639584f876cffed0959c0'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readr)     \nlibrary(xopen)    \nlibrary(glue)     \nlibrary(stringi)   \nlibrary(xml2)\nlibrary(knitr)\nlibrary(rvest)\n```\n:::\n\n\n## Collect Product Categories\n\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-2_b47ca18ceb4a16cc32878bc2cb3dfd9a'}\n\n```{.r .cell-code}\nurl_home          <- \"https://www.rosebikes.com/bikes/mtb/cross-country\"\nxopen(url_home)\nhtml_home         <- read_html(url_home)\n\nbike_category_tbl <- html_home %>%\n  html_nodes(css = \"a.btn.btn--primary.btn--block.catalog-category-bikes__button\") %>%\n  html_attr('href') %>%\n  enframe(name = \"position\", value = \"subdirectory\") %>%\n  mutate(\n    url = glue(\"https://www.rosebikes.com{subdirectory}\")\n  ) %>%\n  distinct(url)\n\n\nkable(head(bike_category_tbl))\n```\n:::\n\n\n## Collect Bike Category and Price----\n\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-3_db761215a4f7386bcac0e4599fcbf068'}\n\n```{.r .cell-code}\nbike_type_tbl <- tibble()\n\nfor (url in bike_category_tbl$url) {\n  xopen(url)\n  html_bike_type <- read_html(url)\n  \n  model_name <- html_bike_type %>%\n    html_nodes(css = \".catalog-category-model__title\") %>%\n    html_text() \n  \n  \n  price <- html_bike_type %>%\n    html_nodes(css = \".catalog-category-model__price-current-value\") %>%\n    html_text() %>%\n    str_remove_all(\"[^0-9.]\") %>%\n    as.numeric()\n  \n  bike_type_tbl <- bind_rows(bike_type_tbl, tibble(model_name, price)) %>%\n    distinct(model_name, .keep_all = TRUE)\n  \n}\nkable(head(bike_type_tbl))\n```\n:::\n\n\n# Challenge 1: API\n\n## Libraries\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-4_c27cf95360c9bdde9b581e87cfba9c1c'}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(httr)\nlibrary(jsonlite)\n```\n:::\n\n\n## API Key Retrieval\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-5_b4623f039fc52c2a4351bd0466ce6392'}\n\n```{.r .cell-code}\napi_key <- Sys.getenv(\"MY_API_KEY\")\nif (is.na(api_key)) {\n  stop(\"API key not found in the .Renviron file.\")\n}\n```\n:::\n\n## Open Weather Map API URL\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-6_16ba26b1acb1de5dcf1a3666c8d080d1'}\n\n```{.r .cell-code}\nweather_response <- GET(glue(\"https://api.openweathermap.org/data/2.55/weather?lat=44.34&lon=10.99&appid={api_key}\"))\n```\n:::\n\n\n## Response Extraction\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-7_6c1fde7ef046df02b222a549957600bb'}\n\n```{.r .cell-code}\ncurrent_weather_data <- content(weather_response, as = \"text\")\ncurrent_weather <- fromJSON(current_weather_data)\n\ntemperature_celsius <- round(current_weather$main$temp - 273.15, 2)\nhumidity_percentage <- current_weather$main$humidity\ndescription <- current_weather$weather[[1]]$description\n```\n:::\n\n## Data Manipulation\n\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-8_8a78ee14fc62121c6d3343496f081540'}\n\n```{.r .cell-code}\ncat(\"Current Weather in:\", description, \"\\n\")\ncat(\"Temperature:\", temperature_celsius, \"Â°C\\n\")\ncat(\"Humidity:\", humidity_percentage, \"%\\n\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}