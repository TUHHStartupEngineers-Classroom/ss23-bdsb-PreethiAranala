{
  "hash": "2b320184ca11e45968ba284eb2a9624b",
  "result": {
    "markdown": "---\ntitle: \"Data Wrangling\"\nauthor: \"Preethi Aranala\"\n---\n\n# LIBRARIES ----\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-1_5d6a049b781863fb522de3a3795ae3dc'}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(lubridate)\n```\n:::\n\n\n# ASSIGNING COLUMN TYPES\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-2_35a0feb6a70a39232928c63e51728a48'}\n\n```{.r .cell-code}\ncol_types <- list(\n  id = col_character(),\n  patent_id = col_character(),\n  assignee_id = col_character(),\n  mainclass_id = col_character(),\n  type = col_character(),\n  number = col_character(),\n  country = col_character(),\n  organization = col_character(),\n  date = col_date(\"%Y-%m-%d\"),\n  abstract = col_character(),\n  title = col_character(),\n  kind = col_character(),\n  num_claims = col_double(),\n  filename = col_character(),\n  withdrawn = col_double(),\n  sequence = col_integer()\n)\n```\n:::\n\n# IMPORTING FILES INTO TABLES\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-3_d8801b124c80218b57904b5a0f63729b'}\n\n```{.r .cell-code}\npatent_tbl <- vroom(\n  file       = \"00_raw_data/Patent_data_reduced/patent.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types[c(\"id\",  \"date\",  \"num_claims\")],\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\npatent_assignee_tbl <- vroom(\n  file       =  \"00_raw_data/Patent_data_reduced/patent_assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types[c(\"patent_id\",   \"assignee_id\")],\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\nassignee_tbl        <- vroom(\n  file       = \"00_raw_data/Patent_data_reduced/assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types[c(\"id\",  \"type\",  \"organization\")],\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n\nuspc_tbl            <- vroom(\n  file       =  \"00_raw_data/Patent_data_reduced/uspc.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types[c(\"patent_id\",  \"mainclass_id\",                                              \"sequence\")],\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n```\n:::\n\n\n# Question 1\n## Manipulating the data        \n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-4_d0d3e71af8e94f85d1e1aa06f872915e'}\n\n```{.r .cell-code}\npatent_assignee_dt <- merge(patent_assignee_tbl, assignee_tbl, by.x = \"assignee_id\", by.y = \"id\", all.x = T) %>%\n  filter(type == 2) %>% \n  group_by(organization) %>%\n  summarize(quantity = n()) %>%\n  arrange(desc(quantity))\n```\n:::\n\n\n## Visualizing the data       \n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-5_5caad2f7dc7f595ce0d3320afe0cce84'}\n\n```{.r .cell-code}\npatent_assignee_dt %>%\n  slice(1:10) %>%\n  ggplot(aes(x=organization, y=quantity)) +\n  geom_label(aes(label = quantity), vjust = -0.2) + \n  geom_col(fill = \"#2DC6D6\") + \n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+ \n  labs(\n    title    = \"Patents by Top US Companies\",\n    x = \"Top 10 US Companies\", # Override defaults for x and y\n    y = \"Quantity\"\n  )\n```\n:::\n\n# Question 2\n## Manipulating the data\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-6_75b6071f8c6405b260e23364f6db1ff2'}\n\n```{.r .cell-code}\npatent_dt2 <- patent_tbl %>%\n  left_join(patent_assignee_tbl, by = c(\"id\" = \"patent_id\")) %>%\n  left_join(assignee_tbl, by = c(\"assignee_id\" = \"id\")) %>%\n  filter(type == 2 & date>= \"2014-08-01\" & date<= \"2014-08-31\") %>% \n  group_by(organization) %>%\n  summarise(quantity = n()) %>%\n  ungroup() %>%\n  arrange(desc(quantity))\n```\n:::\n\n## Visualizing the data       \n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-7_2dcc4ad04e08477063e360f8d2e6b564'}\n\n```{.r .cell-code}\npatent_dt2 %>%\n  slice(1:10) %>%\n  ggplot(aes(x=organization, y=quantity)) +\n  geom_label(aes(label = quantity), vjust = -0.2) + \n  geom_col(fill = \"#2DC6D6\") + \n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+ \n  labs(\n    title    = \"Most Patents by Top US Companies in August 2014\",\n    x = \"Top 10 US Companies\", # Override defaults for x and y\n    y = \"Quantity\"\n  )\n```\n:::\n\n# Question 3\n## Manipulating the data\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-8_d3ed829e2c4ecfd960f7d1e00190926f'}\n\n```{.r .cell-code}\npatent_dt3 <- patent_assignee_tbl %>%\n  left_join(assignee_tbl, by = c(\"assignee_id\" = \"id\"), relationship = \"many-to-many\") %>%\n  left_join(uspc_tbl, by = c(\"patent_id\" = \"patent_id\"), relationship = \"many-to-many\")\n\ntop_10_companies <- patent_dt3 %>%\n  group_by(organization) %>%\n  summarise(num_patents = n()) %>%\n  top_n(10, num_patents)\n\ntop_5_USPTO <- patent_dt3 %>%\n  filter(organization %in% top_10_companies$organization) %>%\n  group_by(mainclass_id) %>%\n  summarise(num_patents_per_mainclass = n()) %>%\n  na.omit() %>%\n  top_n(5,num_patents_per_mainclass)\n```\n:::\n\n## Visualizing the data\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-9_c2cc86b1bf1e8397c5b237358328d6cb'}\n\n```{.r .cell-code}\ntop_5_USPTO %>%\n  ggplot(aes(x=mainclass_id, y=num_patents_per_mainclass)) +\n  geom_label(aes(label = num_patents_per_mainclass), vjust = -0.2) + \n  geom_col(fill = \"#2DC6D6\") + \n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+ \n  labs(\n    title    = \"Top 5 USPTO Classes by Top 10 Companies\",\n    x = \"Main Class ID\", # Override defaults for x and y\n    y = \"Quantity\"\n  )\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}