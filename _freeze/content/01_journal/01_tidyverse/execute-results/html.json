{
  "hash": "47780fba3f34f9b524ee031e19497093",
  "result": {
    "markdown": "---\nformat: html\ntitle: \"Tidyverse\"\nauthor: \"Preethi Aranala\"\n---\n\n\nSALES ANALYSIS ----\n\nThe following is the code to analyze the bike sales based on different location and based on year.\n\n# Loading necessary libraries ----\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-1_6c0f89687fedd2fa220d8a8f405a9269'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(rmarkdown)\n```\n:::\n\n\n# Importing Files ----\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-2_10f882ef3bb0ea9a9374dd4ffd55f12d'}\n\n```{.r .cell-code}\nbikes_tbl <- readxl::read_excel(\"C:/Users/Preethi Aranala/OneDrive/Documents/GitHub/ss23-bdsb-PreethiAranala2/content/00_data/01_bike_sales/01_raw_data/bikes.xlsx\")\n\nbikeshops_tbl <- readxl::read_excel(\"C:/Users/Preethi Aranala/OneDrive/Documents/GitHub/ss23-bdsb-PreethiAranala2/content/00_data/01_bike_sales/01_raw_data/bikeshops.xlsx\")\n\norderlines_tbl <- readxl::read_excel(\"C:/Users/Preethi Aranala/OneDrive/Documents/GitHub/ss23-bdsb-PreethiAranala2/content/00_data/01_bike_sales/01_raw_data/orderlines.xlsx\")\n```\n:::\n\n\n# Examining Data ----\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-3_424264da41d075f8bb36415c0f3b4d3e'}\n\n```{.r .cell-code}\nbikes_tbl %>% glimpse()\nbikeshops_tbl %>% glimpse()\norderlines_tbl %>% glimpse()\n```\n:::\n\n\n# Joining Data ----\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-4_cf2d996eeb075b06803719107f85234a'}\n\n```{.r .cell-code}\nbike_orderlines_joined_tbl <- orderlines_tbl %>%\n        left_join(bikes_tbl, by = c(\"product.id\" = \"bike.id\")) %>%\n        left_join(bikeshops_tbl, by = c(\"customer.id\" = \"bikeshop.id\"))\n\nbike_orderlines_joined_tbl %>% glimpse()\n```\n:::\n\n\n# Wrangling Data ----\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-5_3103f3386faf1e01b63957b3a6d76101'}\n\n```{.r .cell-code}\nbike_orderlines_wrangled_tbl <- bike_orderlines_joined_tbl %>%\n  separate(col    = location,\n           into   = c(\"city\", \"state\"),\n           sep    = \",\") %>%\n  mutate(total.price = price * quantity) %>%\n  select(-...1, -gender) %>%\n  select(-ends_with(\".id\")) %>%\n  bind_cols(bike_orderlines_joined_tbl %>% select(order.id)) %>% \n  select(order.id, contains(\"order\"), contains(\"model\"), contains(\"location\"),\n         price, quantity, total.price,\n         everything()) %>%\n  rename(bikeshop = name) %>%\n  set_names(names(.) %>% str_replace_all(\"\\\\.\", \"_\"))\n```\n:::\n\n\n# Business Insights ----\n\n## Sales by Location ----\n\n### Step 1 - Manipulate\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-6_52214813fa50751bf664536edd7ddaa3'}\n\n```{.r .cell-code}\nsales_by_loc_tbl <- bike_orderlines_wrangled_tbl %>%\ngroup_by(state) %>% \nsummarize(sales = sum(total_price)) %>%\nmutate(revenue = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\n\nsales_by_loc_tbl\n```\n:::\n\n\n### Step 2 - Visualize\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-7_bfb8a8ebb3ecf4df579226a6dd42c7fd'}\n\n```{.r .cell-code}\nsales_by_loc_tbl %>%\nggplot(aes(x = state, y = sales)) +\ngeom_col(fill = \"#2DC6D6\") + \ngeom_label(aes(label = revenue)) + \nscale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\ntheme(axis.text.x = element_text(angle = 45, hjust = 1))+                 labs(\n    title    = \"Revenue by State\",\n    x = \"\", # Override defaults for x and y\n    y = \"Revenue\"\n  )\n```\n:::\n\n[![Plot showing revenue obtained by bikeshops in different states of Germany](/content/04_web_images/01_01.jpeg)]\n\n\n## Sales by State and Year ----\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-8_aa91239124fb5d319c13e88e55778259'}\n\n```{.r .cell-code}\nlibrary(lubridate)\n```\n:::\n\n\n### Step 1 - Manipulate\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-9_5b81b3d83df771a3ba7d0e19da70e0c9'}\n\n```{.r .cell-code}\nsales_by_year_tbl <- bike_orderlines_wrangled_tbl %>%\nselect(state, order_date, total_price) %>%\nmutate(year = year(order_date)) %>%\ngroup_by(state, year) %>% \nsummarize(sales = sum(total_price)) %>%\nmutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\nsales_by_year_tbl\n```\n:::\n\n\n### Step 2 - Visualize\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-10_04b1977c9af539a6daf75e63d0339095'}\n\n```{.r .cell-code}\nsales_by_year_tbl %>%\n  ggplot(aes(x = year, y = sales, fill = state)) +\n  geom_col() + # Run up to here to get a stacked bar plot\n  facet_wrap(~ state) +\n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title = \"Revenue by Year and State\",\n    fill = \"States\" \n  )\n```\n:::\n\n[![Plots showing the revenue of bikeshops over a set of years and in different states in Germany](/content/04_web_images/01_02.jpeg)\n\n\n# Writing Files ----\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-11_f0310143353f196df830b193a30923dc'}\n\n```{.r .cell-code}\nlibrary(writexl)\n```\n:::\n\n\n## Excel ----\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-12_b7f2a8447e2b0494235474bd4c9793c9'}\n\n```{.r .cell-code}\nbike_orderlines_wrangled_tbl %>% \nwrite_xlsx(\"content/00_data/01_bike_sales/02_wrangled_data/bike_orderlines.xlsx\")\n```\n:::\n\n\n## CSV ----\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-13_68e81f9fcfe3e669e517aefa2de42025'}\n\n```{.r .cell-code}\nbike_orderlines_wrangled_tbl %>% \nwrite_csv(\"content/00_data/01_bike_sales/02_wrangled_data/bike_orderlines.csv\")\n```\n:::\n\n\n## RDS ----\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-14_2c9a186428a3e3fc414379fa6efa5bef'}\n\n```{.r .cell-code}\nbike_orderlines_wrangled_tbl %>% \nwrite_rds(\"content/00_data/01_bike_sales/02_wrangled_data/bike_orderlines.rds\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}